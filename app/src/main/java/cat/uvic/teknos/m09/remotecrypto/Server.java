/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package cat.uvic.teknos.m09.remotecrypto;

import java.io.*;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.Base64;
import java.util.Scanner;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class Server {
    public static final int PORT = 50001;

    public static void main(String[] args) throws IOException {

        var server = new ServerSocket(PORT);
        System.out.println("Server listening on port" + server.getLocalPort());

        var threadExecutor = Executors.newFixedThreadPool(3);


        while (true){
            var client = server.accept();
            var thread = new ClientThread(client);
            threadExecutor.execute(thread);
//
//            threadExecutor.execute(() -> {
//                System.out.println("Thread: " + Thread.currentThread().getName());
//
//                PrintWriter outputStream = null;
//                try {
//                    outputStream = new PrintWriter(client.getOutputStream());
//                } catch (IOException e) {
//                    throw new RuntimeException(e);
//                }
//
//                outputStream.println("Type text to encode in base64 otherwise press enter");
//                outputStream.flush();
//
//                BufferedReader inputStream = null;
//                try {
//                    inputStream = new BufferedReader(new InputStreamReader( client.getInputStream()));
//                } catch (IOException e) {
//                    throw new RuntimeException(e);
//                }
//
//                String data = null;
//                try {
//                    data = inputStream.readLine();
//                } catch (IOException e) {
//                    throw new RuntimeException(e);
//                }
//
//                var encoder = Base64.getEncoder();
//
//                while (!data.equals("")){
//                    outputStream.println(encoder.encodeToString(data.getBytes()));
//                    outputStream.flush();
//                    outputStream.println("Type text to encode in base64 otherwise press enter");
//                    outputStream.flush();
//                    try {
//                        data = inputStream.readLine();
//                    } catch (IOException e) {
//                        throw new RuntimeException(e);
//                    }
//
//                }
//                try {
//                    client.close();
//                } catch (IOException e) {
//                    throw new RuntimeException(e);
//                }
//            });
//
        }


    }


}
